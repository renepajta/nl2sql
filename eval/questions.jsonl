{"id": "q_basic_survived_children_master_under5", "question": "Among passengers younger than 5 with a title 'Master.' in the Name, excluding 'Miss.', how many survived? Return a single number.", "gold_sql": "SELECT COUNT(1)\n                       FROM titanic\n                       WHERE Age < 5\n                         AND Name LIKE 'Master.%'\n                         AND Name NOT LIKE 'Miss.%'\n                         AND Survived = 1", "skip": false}
{"id": "q_cabin_b_q_parch_gt2_no_ticket", "question": "How many passengers have Cabin starting with 'B', embarked at 'Q', Parch > 2, and an empty or NULL Ticket? Return a single number.", "gold_sql": "SELECT COUNT(1)\n                       FROM titanic\n                       WHERE Cabin LIKE 'B%'\n                         AND Embarked = 'Q'\n                         AND Parch > 2\n                         AND (Ticket IS NULL OR trim(Ticket) = '')", "skip": false}
{"id": "q_female_mary_maria_shared_ticket_not_c_cabin_survived", "question": "How many female passengers named Mary or Maria (Name contains ' Mary ' or ' Maria '), excluding Cabin values that start with 'C', survived AND had ticket shared by more than three people? Return a single number.", "gold_sql": "WITH ticket_counts AS (\n                           SELECT Ticket, COUNT(*) AS n\n                           FROM titanic\n                           WHERE Ticket IS NOT NULL AND trim(Ticket) <> ''\n                           GROUP BY Ticket\n                       )\n                       SELECT COUNT(1)\n                       FROM titanic t\n                       JOIN ticket_counts tc ON t.Ticket = tc.Ticket\n                       WHERE t.Sex = 'female'\n                         AND (t.Name LIKE '% Mary %' OR t.Name LIKE '% Maria %')\n                         AND (t.Cabin IS NULL OR t.Cabin NOT LIKE 'C%')\n                         AND t.Survived = 1\n                         AND tc.n > 3", "skip": false}
{"id": "q_queenstown_not_southampton_mislabelled_class_siblings_exclude_minors", "question": "Considering passengers who embarked at Queenstown but not Southampton, and who might be 2nd class but recorded as 3rd in some places, how many had siblings onboard, excluding minors counted as adults?", "why_skip": "Contradictory/mislabeled filters by design; not strictly answerable with a single SQL over one canonical table.", "skip": true}
{"id": "q_dual_embarkation_c_and_s_average_fare", "question": "Average fare of passengers embarked from Cherbourg and Southampton at the same time (assume logging error marked both).", "why_skip": "Logical contradiction; requires dedup/versioned records or dirty-data modelling beyond single-table SQL.", "skip": true}
{"id": "q_versioning_incorrect_survival_age_corrections", "question": "Percentage of passengers who died but were mis-marked as survived in a secondary dataset and had age corrected from >70 to <60.", "why_skip": "Requires cross-version lineage tracking not present in single Titanic table.", "skip": true}
